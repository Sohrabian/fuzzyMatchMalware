import pandas as pd
from rapidfuzz import process, fuzz, utils

threshold = 100

list1 = ['AttachThreadInput','CallNextHookEx','GetAsyncKeyState','GetClipboardData',
    'GetDC','GetDCEx','GetForegroundWindow','GetKeyboardState','GetKeyState','GetMessageA',
    'GetRawInputData','GetWindowDC','MapVirtualKeyA','MapVirtualKeyExA','PeekMessageA','PostMessageA',
    'PostThreadMessageA','RegisterHotKey','RegisterRawInputDevices','SendMessageA','SendMessageCallbackA',
    'SendMessageTimeoutA','SendNotifyMessageA','SetWindowsHookExA','SetWinEventHook','UnhookWindowsHookEx',
    'BitBlt','StretchBlt','GetKeynameTextA']
    
list2 = ['#!This program cannot be run in DOS mode.','+=+B+G&~','+5+:+?+D+I',
        'HostService','HostService','<Module>','mscorlib','System.Windows.Forms',
        'MulticastDelegate','EventArgs','ValueType','IDisposable','ReadOnlyCollectionBase',
        'System.Collections','Settings','HostService.Properties','ApplicationSettingsBase',
        'System.Configuration','Attribute','GetString','SmartAssembly.Delegates',
        'MemberRefsProxy','SmartAssembly.HouseOfCards','MemoryManager',
        'SmartAssembly.MemoryManagement','MemoryStream','System.IO',
        'PoweredByAttribute','SmartAssembly.Attributes','CultureInfo','System.Globalization',
        'FileStream','System.Collections.Generic','BackgroundWorker','System.ComponentModel',
        'System.Net.Sockets','IContainer','KeyEventHandler','KeyPressEventHandler',
        'MouseEventHandler','EventHandler','Dictionary`2','Assembly','System.Reflection',
        'ModuleHandle','Encoding','System.Text','get_ASCII','get_UTF8','GetBytes','set_Size',
        'System.Drawing','set_ClientSize','set_MaximumSize','set_Visible','set_Enabled',
        'set_ShowInTaskbar','set_ControlBox','set_MaximizeBox','set_MinimizeBox',
        'set_ShowIcon','ResumeLayout','FtpWebRequest','System.Net',
        'set_UsePassive','set_UseBinary','set_KeepAlive','GetExecutingAssembly',
        'get_Location','get_FullName','ToString','InputLanguage','get_LayoutName',
        'FileSystemInfo','get_Name','System.Diagnostics','get_ProcessName','Exception',
        'get_Message','get_MainWindowTitle','TextReader','ReadToEnd','EndsWith','Contains',
        'StartsWith','set_Interval','add_Tick','add_Load','add_DoWork','DoWorkEventHandler',
        'add_RunWorkerCompleted','RunWorkerCompletedEventHandler','DateTime','RunWorkerAsync',
        'TextWriter','SuspendLayout','WebResponse','SymmetricAlgorithm',
        'System.Security.Cryptography','op_Equality','op_Inequality',
        'KeyPressEventArgs','get_KeyChar','KeyEventArgs','get_Control',
        'get_Handled','get_SuppressKeyPress','IEnumerator','MoveNext',
        'get_KeyCode','Clipboard','ContainsText','TextDataFormat','WebClient',
        'set_Credentials','ICredentials','WebRequest','DownloadString','Application',
        'get_StartupPath','get_ExecutablePath','Environment','get_MachineName','GetHostName',
        'DownloadFile','EnableVisualStyles','Directory','IsNullOrEmpty','GetDirectories',
        'ReadAllLines','GetAttributes','FileAttributes','SetAttributes','GetModules',
        'System.Runtime.InteropServices','GetHINSTANCE','GetTypeFromHandle',
        'RuntimeTypeHandle','PtrToStructure','get_CurrentInputLanguage',
        'MessageBox','DialogResult','IsLetter','MouseEventArgs','SetCompatibleTextRenderingDefault',
        'get_Length','ArrayList','get_Count','get_Major','get_LCID','get_KeySize',
        'get_InnerList','get_Item','GetFullPath','GetFileName','GetPathRoot','AllocHGlobal',
        'op_Explicit','WriteLine','System.Threading','FreeHGlobal','Delegate','get_Position',
        'SafeHandle','DangerousGetHandle','get_Handle','StructureToPtr','get_OSVersion',
        'OperatingSystem','get_Platform','PlatformID','get_Version','FileMode','FileAccess',
        'set_Text','set_Name','set_Method','GetFiles','UploadFile','get_Chars','CreateDirectory',
        'DirectoryInfo','Substring','GetFolderPath','SpecialFolder','GetProcesses','RegistryKey',
        'Microsoft.Win32','OpenSubKey','CreateSubKey','SetValue','RegistryValueKind',
        'set_WindowState','FormWindowState','ContainerControl','set_AutoScaleMode',
        'AutoScaleMode','set_FormBorderStyle','FormBorderStyle','set_Opacity',
        'set_SizeGripStyle','SizeGripStyle','get_White','get_Black','set_TransparencyKey',
        'add_FormClosed','FormClosedEventHandler','MessageBoxButtons','MessageBoxIcon',
        'GetEnumerator','get_Current','GetHostEntry','IPHostEntry','get_AddressList',
        'IPAddress','get_AddressFamily','AddressFamily','get_SafeFileHandle',
        'SafeFileHandle','Microsoft.Win32.SafeHandles','get_CreationTime',
        'get_LastWriteTime','SetCreationTime','SetLastWriteTime','FileInfo','GetAccessControl',
        'FileSecurity','System.Security.AccessControl','SetAccessControl','GetResponse',
        'WebException','get_Response','GetResponseStream','FtpWebResponse','get_StatusCode',
        'FtpStatusCode','BitConverter','GetProcessById','FromBase64String','DeriveBytes',
        'CreateDecryptor','ICryptoTransform','ReadInt32','StringComparison','LastIndexOf',
        'Graphics','FromImage','get_Size','CopyFromScreen','SetPixel','ImageFormat',
        'System.Drawing.Imaging','get_Jpeg','SettingsBase','Synchronized',
        'GetManifestResourceStream','BeginInvoke','IAsyncResult','AsyncCallback',
        'EndInvoke','DoWorkEventArgs','RunWorkerCompletedEventArgs',
        'FormClosedEventArgs','NetServerEnum','Netapi32','NetApiBufferFree','CloseHandle',
        'kernel32','CallNextHookEx','user32.dll','GetKeyboardLayout','NetShareEnum',
        'netapi32','CreateFile','GetWindowThreadProcessId','StrongNameSignatureVerificationEx',
        'mscorwks.dll','SetWindowsHookEx','MouseButtons','MoveFileEx','UnhookWindowsHookEx',
        'ResolveEventArgs','RegisterDeviceNotification','UnregisterDeviceNotification',
        'GetKeyboardState','GetForegroundWindow','StringBuilder','GetWindowText','GetKeyState',
        'assemblyFullName','callback','CreateMemberRefsDelegates','CreateGetStringDelegate',
        'ownerType','SetProcessWorkingSetSize','IsWebApplication','AssemblyTitleAttribute',
        'RuntimeCompatibilityAttribute','System.Runtime.CompilerServices',
        'AssemblyDescriptionAttribute','AssemblyConfigurationAttribute',
        'AssemblyCompanyAttribute','AssemblyProductAttribute',
        'AssemblyCopyrightAttribute','AssemblyTrademarkAttribute','ComVisibleAttribute',
        'GuidAttribute','AssemblyFileVersionAttribute','NeutralResourcesLanguageAttribute',
        'System.Resources','DebuggableAttribute','DebuggingModes','CompilationRelaxationsAttribute',
        'SuppressIldasmAttribute','FlagsAttribute','DefaultMemberAttribute','CompilerGeneratedAttribute',
        'GeneratedCodeAttribute','System.CodeDom.Compiler','AttributeUsageAttribute','AttributeTargets',
        'SuppressUnmanagedCodeSecurityAttribute','System.Security','STAThreadAttribute',
        '{32e73288-117b-4b18-a0c3-1ebfb328a8f7}','{d8e55115-4b1c-440e-8e9a-84099f207bc1}',
        'ParameterizedThreadStart','set_IsBackground','add_Activated','SecurityException',
        'SocketType','ProtocolType','Enumerator','NetworkCredential','add_ApplicationExit',
        'ArgumentOutOfRangeException','InvalidOperationException','ReadByte','CreateEncryptor',
        'DESCryptoServiceProvider','Interlocked','CompareExchange','RijndaelManaged',
        'StreamWriter','FormatException','RuntimeHelpers','InitializeArray',
        'RuntimeFieldHandle','TransformFinalBlock','GetCallingAssembly',
        'VolumeSeparatorChar','DirectorySeparatorChar','ResolveEventHandler',
        'AppDomain','get_CurrentDomain','add_AssemblyResolve','Registry',
        'CurrentUser','ToBase64String','ContainsKey','GetTempPath',
        'OpenWrite','LoadFile','set_Item','FileLoadException','BadImageFormatException',
        'SystemException','ArgumentNullException','Rfc2898DeriveBytes','CryptoStream',
        'CryptoStreamMode','StreamReader','get_LParam','set_Result','get_WParam','AssemblyName',
        'GetPublicKey','GetCurrentProcess','get_MainModule','ProcessModule','get_ModuleName',
        'ResolveTypeHandle','MemberInfo','ResolveMethodHandle','RuntimeMethodHandle',
        'MethodBase','GetMethodFromHandle','MethodInfo','get_IsStatic','FieldInfo',
        'get_FieldType','CreateDelegate','GetParameters','ParameterInfo','get_ParameterType',
        'get_ReturnType','DynamicMethod','System.Reflection.Emit','GetILGenerator','ILGenerator',
        'Tailcall','Callvirt','GetFields','BindingFlags','get_ModuleHandle','get_Module',
        'GetMethods','get_MetadataToken','get_Ticks','add_Idle','add_ResourceResolve',
        'GetManifestResourceNames','StackFrame','GetMethod','get_Assembly','StackTrace',
        'GetFrames','TryGetValue','Wrong Header Signature','Unknown Header',
        'ezRmNzVkMTc1LThkMzktNDY1Ny1hZGQwLWVhYjE2ZDg5YWMxNX0sIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49M2U1NjM1MDY5M2Y3MzU1ZQ==,[z]{32e73288-117b-4b18-a0c3-1ebfb328a8f7},ezRmNzVkMTc1LThkMzktNDY1Ny1hZGQwLWVhYjE2ZDg5YWMxNX0=,[z]{32e73288-117b-4b18-a0c3-1ebfb328a8f7}',
        'w3wp.exe','aspnet_wp.exe',', Version=',', Culture=',', PublicKeyToken=',
        'Version=','Culture=','PublicKeyToken=',
        '{4f75d175-8d39-4657-add0-eab16d89ac15}, PublicKeyToken=3e56350693f7355e',
        '{d8e55115-4b1c-440e-8e9a-84099f207bc1}','{71461f04-2faa-4bb9-a0dd-28a79101b599}',
        'HostService','WrapNonExceptionThrows','Microsoft Corporation Products',
        'Microsoft','Copyright ','$b8886a9e-20d5-47ed-ada6-6477a8db8460',
        'Powered by SmartAssembly 6.9.0.114',
        'KMicrosoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator','12.0.0.0',
        'MUBtZUZvciRHaWRvcmE=',
        'NjIzNTFjZjc2NDE2Mjk1Mw==$QXNzZW1ibHkgaGFzIGJlZW4gdGFtcGVyZWQ=(XEFkb2JlXEZsYXNoIFBsYXllclxBRkNhY2hlXA==',
        'XEFkb2JlXA==','c3lzTG9ncy5kYXQ=0ZnRwOi8vZnRwLmJ5ZXRob3N0MTAuY29tL2h0ZG9jcy9JUi8=',
        'YjEwXzE2NDc5MzMw',
        'a29zZW5hbmVraGFtZW5lZWU=XLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo= LS0tLSBQcm9ncmFtIFN0YXJ0IEF0IFsg',
        'ZGQvTU0veXl5eSB8IEg6bW06c3M=','IF0gSW5bIA==','IF0gTGV0cyBHbyAtLS0tCg==',
        'LSBMb2NhbCBOZXR3b3JrIElwOiA=','LSBQdWJsaWMgSXA6IA==','ZmEtaXI=',
        'cGVyc2lhbg==','ClsgY2xwIF0=','WyBjbHAgXQo=','LSBbV2luIFRpdGxlOg==',
        'c3lzRGF0YS5kYXQ=,XEZsYXNoIFBsYXllclxBRkNhY2hlXHN5c0RhdGEuZGF0','c3lzUmVwLmRhdA==',
        'c2hhcmU=','VXNlcnM=','U2hhcmU=','U2hhcmVz','XHBpY3MuZXhl','SVBDJA==','XFx7MH1cezF9',
        'Ki5qcGc=','U1RPUg==','Rmxhc2ggUGxheWVyXA==','Rmxhc2ggUGxheWVyXEFGQ2FjaGVc','ZXhwbG9yZXIuZXhl',
        'LmpwZw== XEFkb2JlXEhvc3RTZXJ2aWNlLmV4ZQ==',
        'SG9zdFNlcnZpY2U=<U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVu CioqKiBUSElTIElTIE5FVyBPTkUuLi4K',
        'Z2lkb3JhXUHJvYmxlbSB3aXRoIGFjZXNzaW5nIG5ldHdvcmsgY29tcHV0ZXJzIGluIE5ldHdvcmtCcm93c2VyIA0KDQoNCg==',
        'RXJyb3I=$QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVo=','SW50ZXJOZXR3b3Jr KiBDYW4gTm90IEdldCBMb2NhbCBJcC4K,XEZsYXNoIFBsYXllclxBRkNhY2hlXHN5c0Rucy5kYXQ=','SGV5JENvbWUwMjFATWVmb3JZb3U=','XE5ldyBmb2xkZXI=','LmV4ZQ==',
        'Ci0gVVNCIERyaXZlPg==DSXMgQ29ubmVjdGVkIEFuZCBXZSBHcm93IFVwIE9uIEl0IFN1Y2Nlc3MgRnVsbCAuLi4K',
        'TUtEHU3RyZWFtIGRpZCBub3QgY29udGFpbiBwcm9wZXJseSBmb3JtYXR0ZWQgYnl0ZSBhcnJheQ==,RGlkIG5vdCByZWFkIGJ5dGUgYXJyYXkgcHJvcGVybHk=(QWN0aXZlIFdpbmRvdyBJZCBFcXVhbHMgRXJyb3I=',
        'UHJvY2Nlc3MgSWQgRXJyb3I=','UHJvY2VzcyBOYW1lIEVycm9y',
        'V2luZG93cyBUaXRsZSBFcnJvcg==0V2luZG93cyBUaXRsZSBXcml0ZSBUbyBTdHJpbmcgRXJyb3I=(TGFzdCBXaW5kb3dzIENoZWNrIFdyaXRlIEVycm9y',
        '2LHZitin2YQ=','Y2lwaGVyVGV4dA==','c2hhcmVkU2VjcmV0','U3BhY2U=','UmV0dXJu','RXNjYXBl','W1NQQUNFXQ==','W1RBQl0=',
        'W0VOVEVSXQ==','W0VTQ10=','ZmlyZWZveA==','ZmlyZSBmb3g=','SW50ZXJuZXQ=','SW50ZXJuZXQgRXhwbG9yZXI=',
        'SW50ZXJuZXRFeHBsb3Jlcg==','Y2hyb21l','Z29vZ2xl','Z29vZ2xlIGNocm9tZQ==','Z29vZ2xlY2hyb21l','b3BlcmE=',
        '2KjYp9mG2qnYr9in2LHbjA==,2KjYp9mG2qnYr9in2LHbjCDYp9uM2YbYqtix2YbYqtuM','2YXYp9mG2K/ZhyDYrdiz2KfYqA==',
        '2KfZhtiq2YLYp9mEINmI2KzZhw== 2qnYp9ix2Kog2KjZhyDaqdin2LHYqg==82K/YsduM2KfZgdiqINmF2KfZhtiv2Ycg2KfbjNmG2KrYsdmG2KrbjA==,2K/YsduM2KfZgdiqINmF2KfZhtiv2Ycg2K3Ys9in2Kg=@2LPYsdmI24zYs9mH2KfbjCDZvtix2K/Yp9iu2Kog2KfbjNmG2KrYsdmG2KrbjA==',
        '2b7Ysdiv2KfYrtiqINmC2KjZiNi2$2K7Yr9mF2KfYqiDYp9uM2YbYqtix2YbYqtuM 2KfYudmE2KfZhSDZhdmI2KzZiNiv24w=$2K/Ysdiu2YjYp9iz2Kog2YXZiNis2YjYr9uM 2K/YsduM2KfZgdiqINmF2KfZhtiv2Yc=',
        '2YXYp9mG2K/ZhyDaqdin2LHYqg==','QmFsYW5jZQ==','VEVKQVJBVCBCQU5L',
        '2KjYp9mG2qk= 2KfbjNmG2KrYsdmG2Kog2KjYp9mG2qk=$2K/YsdmI2KfYstmHINm+2LHYr9in2K7Yqg==,2b7Ysdiv2KfYrtiqINin2YTaqdiq2LHZiNmG24zaqQ==(2b7Ysdiv2KfYrtiqINin24zZhtiq2LHZhtiq24w=',
        'UGF5bWVudA==','ZXBheQ==','Y2FyZCBpbmZv','2LTZhdin2LHZhyDaqdin2LHYqg==',
        'c2FtYW5lcGF5$aHR0cDovL2NoZWNraXAuZHluZG5zLm9yZy8=','QWRkcmVzczog',
        'PC9ib2R5Pg==$KiBDYW4gTm90IEdldCBQdWJsaWMgSXAuCg==','ZGQtTU0teXlfSC1tbS1zcy1tcw==','U2NyLQ==',
        'LSBTaG90Ww==','XSBBdDo+(v','_CorExeMain','mscoree.dll','RTVVjrqmjr}','!/9?NGGaaq^^^m','+388<<a^^^^]^',
        '#%88<Ca[]]]]]','#%''CCZ[^\\\]','#%''<[[^^\\]',
        '#%''<_a[^^^\^','#%''<<aa^^^^^','##''<_am^m^^m',
        '%%8D<aabm^^m','#-8<Iaammmmm',
        '#%89addammmr','$-8<Gdnmmmj',
        '$-8GIdnnjrr','$-8GGhnsrr}','$-9Gdhnszz','$-9GGggs}s','+-9Ghgys','$1;GVvys',
        'Translation','StringFileInfo','000004b0','Comments','Microsoft Corporation Products',
        'CompanyName','Microsoft','FileDescription','HostService','FileVersion','InternalName',
        'HostService.exe','LegalCopyright','Copyright ','LegalTrademarks','Microsoft','OriginalFilename',
        'HostService.exe','ProductName','HostService','ProductVersion','Assembly Version']


response = []
for name_to_find in list1:
    resp_match =  process.extractOne(name_to_find ,list2)
    if resp_match[1] == threshold:
         row = {'sample_name':name_to_find,'actual_name':resp_match[0], 'score':resp_match[1]}
         response.append(row)
         print(row)

results = pd.DataFrame(response)
print(results)

# If you need all the 'actual_name' tp be in the datframe, continue below
# Otherwise don't include these last 2 lines of code
#unmatched = pd.DataFrame([x for x in list2 if x not in list(results['actual_name'])], columns=['actual_name'])
#results = results.append(unmatched, sort=False).reset_index(drop=True)